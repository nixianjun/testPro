<?xml version="1.0" encoding="UTF-8" ?>   
    <!DOCTYPE mapper   
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="StatDAO">
	<insert id="insertOrUpdateStat" parameterType="java.util.Map">
		insert into
		td_userstat_total(`uid`, `${key}`) values(#{uid},#{value})
		on duplicate
		key update `${key}`=#{value}
	</insert>
	<insert id="insertOrUpdateDailyStat" parameterType="java.util.Map">
		insert into
		${tableName}(`uid`, `day${day}`) values(#{uid},#{value})
		on duplicate
		key update `day${day}`=#{value}
	</insert>
	<insert id="insertOrAddDailyStat" parameterType="java.util.Map">
		insert into
		${tableName}(`uid`, `day${day}`) values(#{uid},#{value})
		on duplicate
		key update `day${day}`=`day${day}` + #{value}
	</insert>
	<insert id="createTable" parameterType="java.util.Map">
		${sql}
	</insert>
	<insert id="insertOrUpdateLastStatId" parameterType="java.util.Map">
		insert into
		td_stat_lastid(`msgType`,`date`,`lastId`)
		values(#{msgType},#{date},#{lastId})
		on duplicate key update `lastId` =
		#{lastId}
	</insert>
	<update id="updateStat" parameterType="java.util.Map">
		update td_userstat_total set `${key}`=#{value} where
		`uid`=#{uid}
	</update>
	<select id="selectLastStatId" parameterType="java.util.Map"
		resultType="int">
		select lastId from td_stat_lastid where
		`msgType`=#{msgType} and `date`=#{date}
	</select>
	<select id="selectUserTotal" parameterType="int" resultType="java.util.Map">
		select * from td_userstat_total where `uid`=#{uid}
	</select>
	<select id="selectUserTotalReturnUserStat" parameterType="int"
		resultType="com.tudou.userstat.model.UserStat">
		select uid,itemCount from td_userstat_total where
		`uid`=#{uid}
	</select>
</mapper>